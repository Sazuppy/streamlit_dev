import streamlit as st
import pandas as pd
from sqlalchemy import create_engine 
from PIL import Image

st.set_page_config(page_title="# –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö StackOverflow", page_icon="üìà")

st.markdown('# –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö StackOverflow')

with st.expander("–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞"):
    st.write("""
        –í—ã –±—É–¥–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö StackOverflow ‚Äî —Å–µ—Ä–≤–∏—Å–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ –æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏. 
    StackOverflow –ø–æ—Ö–æ–∂ –Ω–∞ —Å–æ—Ü–∏–∞–ª—å–Ω—É—é —Å–µ—Ç—å ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–µ—Ä–≤–∏—Å–∞ –∑–∞–¥–∞—é—Ç –≤–æ–ø—Ä–æ—Å—ã, –æ—Ç–≤–µ—á–∞—é—Ç –Ω–∞ –ø–æ—Å—Ç—ã, –æ—Å—Ç–∞–≤–ª—è—é—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ —Å—Ç–∞–≤—è—Ç –æ—Ü–µ–Ω–∫–∏ –¥—Ä—É–≥–∏–º –æ—Ç–≤–µ—Ç–∞–º.  
–í—ã –±—É–¥–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–µ—Ä—Å–∏–µ–π –±–∞–∑—ã, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –æ –ø–æ—Å—Ç–∞—Ö –∑–∞ 2008 –≥–æ–¥, –Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö –≤—ã –Ω–∞–π–¥—ë—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –æ –±–æ–ª–µ–µ –ø–æ–∑–¥–Ω–∏—Ö –æ—Ü–µ–Ω–∫–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–∏ –ø–æ—Å—Ç—ã –ø–æ–ª—É—á–∏–ª–∏.  

    –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:

- –¢–∞–±–ª–∏—Ü–∞ badges:
    –•—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–Ω–∞—á–∫–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏—Å—É–∂–¥–∞—é—Ç—Å—è –∑–∞ —Ä–∞–∑–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–≤—à–∏–π –Ω–∞ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ PostgreSQL, –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–æ–∫ postgresql. 
    - id	–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–Ω–∞—á–∫–∞, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á —Ç–∞–±–ª–∏—Ü—ã
    - name	–ù–∞–∑–≤–∞–Ω–∏–µ –∑–Ω–∞—á–∫–∞
    - user_id	–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏—Å–≤–æ–∏–ª–∏ –∑–Ω–∞—á–æ–∫, –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á, –æ—Ç—Å—ã–ª–∞—é—â–∏–π –∫ —Ç–∞–±–ª–∏—Ü–µ users
    - creation_date	–î–∞—Ç–∞ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏—è –∑–Ω–∞—á–∫–∞
    
- –¢–∞–±–ª–∏—Ü–∞ post_types:
–°–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∏–ø–µ –ø–æ—Å—Ç–æ–≤. –ò—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–≤–∞:
    - Question ‚Äî –ø–æ—Å—Ç —Å –≤–æ–ø—Ä–æ—Å–æ–º;
    - Answer ‚Äî –ø–æ—Å—Ç —Å –æ—Ç–≤–µ—Ç–æ–º.

    - id	–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Å—Ç–∞, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á —Ç–∞–±–ª–∏—Ü—ã
    - type	–¢–∏–ø –ø–æ—Å—Ç–∞
- –¢–∞–±–ª–∏—Ü–∞ posts:
–°–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—Å—Ç–∞—Ö.

    - id	–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Å—Ç–∞, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á —Ç–∞–±–ª–∏—Ü—ã
    - title	–ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞
    - creation_date	–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞
    - favorites_count	–ß–∏—Å–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ—Å—Ç –¥–æ–±–∞–≤–∏–ª–∏ –≤ ¬´–ó–∞–∫–ª–∞–¥–∫–∏¬ª
    - last_activity_date	–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –≤ –ø–æ—Å—Ç–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
    - last_edit_date	–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å—Ç–∞
    - user_id	–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–ª –ø–æ—Å—Ç, –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ —Ç–∞–±–ª–∏—Ü–µ users
    - parent_id	–ï—Å–ª–∏ –ø–æ—Å—Ç –Ω–∞–ø–∏—Å–∞–ª–∏ –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –¥—Ä—É–≥—É—é –ø—É–±–ª–∏–∫–∞—Ü–∏—é, –≤ —ç—Ç–æ –ø–æ–ª–µ –ø–æ–ø–∞–¥—ë—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Å—Ç–∞ —Å –≤–æ–ø—Ä–æ—Å–æ–º
    - post_type_id	–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∏–ø–∞ –ø–æ—Å—Ç–∞, –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ —Ç–∞–±–ª–∏—Ü–µ post_types
    - score	–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—á–∫–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–±—Ä–∞–ª –ø–æ—Å—Ç
    - views_count	–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
- –¢–∞–±–ª–∏—Ü–∞ users:
–°–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö.

    - id	–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á —Ç–∞–±–ª–∏—Ü—ã
    - creation_date	–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    - display_name	–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    - last_access_date	–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞
    - location	–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
    - reputation	–û—á–∫–∏ —Ä–µ–ø—É—Ç–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—É—á–∞—é—Ç –∑–∞ —Ö–æ—Ä–æ—à–∏–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –ø–æ–ª–µ–∑–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
    - views	–ß–∏—Å–ª–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –¢–∞–±–ª–∏—Ü–∞ vote_types:
–°–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∏–ø–∞—Ö –≥–æ–ª–æ—Å–æ–≤. –ì–æ–ª–æ—Å ‚Äî —ç—Ç–æ –º–µ—Ç–∫–∞, –∫–æ—Ç–æ—Ä—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å—Ç–∞–≤—è—Ç –ø–æ—Å—Ç—É. –¢–∏–ø–æ–≤ –±—ã–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ: 
    - UpMod ‚Äî —Ç–∞–∫—É—é –æ—Ç–º–µ—Ç–∫—É –ø–æ–ª—É—á–∞—é—Ç –ø–æ—Å—Ç—ã —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –∏–ª–∏ –æ—Ç–≤–µ—Ç–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ—Å—á–∏—Ç–∞–ª–∏ —É–º–µ—Å—Ç–Ω—ã–º–∏ –∏ –ø–æ–ª–µ–∑–Ω—ã–º–∏.
    - DownMod ‚Äî —Ç–∞–∫—É—é –æ—Ç–º–µ—Ç–∫—É –ø–æ–ª—É—á–∞—é—Ç –ø–æ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫–∞–∑–∞–ª–∏—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –Ω–∞–∏–º–µ–Ω–µ–µ –ø–æ–ª–µ–∑–Ω—ã–º–∏.
    - Close ‚Äî —Ç–∞–∫—É—é –º–µ—Ç–∫—É —Å—Ç–∞–≤—è—Ç –æ–ø—ã—Ç–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–µ—Ä–≤–∏—Å–∞, –µ—Å–ª–∏ –∑–∞–¥–∞–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å –Ω—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –∏–ª–∏ –æ–Ω –≤–æ–æ–±—â–µ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.
    - Offensive ‚Äî —Ç–∞–∫—É—é –º–µ—Ç–∫—É –º–æ–≥—É—Ç –ø–æ—Å—Ç–∞–≤–∏—Ç—å, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ –≤–æ–ø—Ä–æ—Å –≤ –≥—Ä—É–±–æ–π –∏ –æ—Å–∫–æ—Ä–±–∏—Ç–µ–ª—å–Ω–æ–π –º–∞–Ω–µ—Ä–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —É–∫–∞–∑–∞–≤ –Ω–∞ –Ω–µ–æ–ø—ã—Ç–Ω–æ—Å—Ç—å –∞–≤—Ç–æ—Ä–∞ –ø–æ—Å—Ç–∞.
    - Spam ‚Äî —Ç–∞–∫—É—é –º–µ—Ç–∫—É —Å—Ç–∞–≤—è—Ç –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –ø–æ—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã–≥–ª—è–¥–∏—Ç –æ—Ç–∫—Ä–æ–≤–µ–Ω–Ω–æ–π —Ä–µ–∫–ª–∞–º–æ–π.

    - id	–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∏–ø–∞ –≥–æ–ª–æ—Å–∞, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
    - name	–ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ç–∫–∏
- –¢–∞–±–ª–∏—Ü–∞ votes:
    –°–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥–æ–ª–æ—Å–∞—Ö –∑–∞ –ø–æ—Å—Ç—ã. 
    - id	–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≥–æ–ª–æ—Å–∞, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
    - post_id	–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Å—Ç–∞, –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ —Ç–∞–±–ª–∏—Ü–µ posts
    - user_id	–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å—Ç–∞–≤–∏–ª –ø–æ—Å—Ç—É –≥–æ–ª–æ—Å, –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ —Ç–∞–±–ª–∏—Ü–µ users
    - bounty_amount	–°—É–º–º–∞ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–∑–Ω–∞—á–∞—é—Ç, —á—Ç–æ–±—ã –ø—Ä–∏–≤–ª–µ—á—å –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –ø–æ—Å—Ç—É
    - vote_type_id	–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∏–ø–∞ –≥–æ–ª–æ—Å–∞, –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ —Ç–∞–±–ª–∏—Ü–µ vote_types
    - creation_date	–î–∞—Ç–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –≥–æ–ª–æ—Å–∞
    """)



db_config = {
    'user': 'praktikum_student', # –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    'pwd': 'Sdf4$2;d-d30pp', # –ø–∞—Ä–æ–ª—å
    'host': 'rc1b-wcoijxj3yxfsf3fs.mdb.yandexcloud.net',
    'port': 6432, # –ø–æ—Ä—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
    'db': 'data-analyst-advanced-sql' # –Ω–∞–∑–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    }  

connection_string = 'postgresql://{}:{}@{}:{}/{}'.format(
        db_config['user'],
        db_config['pwd'],
        db_config['host'],
        db_config['port'],
        db_config['db'],
    )
engine = create_engine(connection_string)

def query_db(query):
    return pd.read_sql_query(query, con=engine)

query_1 = '''SELECT date_trunc('month', creation_date) as month_date, sum(views_count) as total_views
FROM stackoverflow.posts
WHERE extract( YEAR from creation_date) = '2008'
GROUP BY month_date
ORDER BY total_views DESC
'''
query_2 = '''SELECT u.display_name, count(DISTINCT p.user_id)
FROM stackoverflow.users as u
JOIN stackoverflow.posts as p ON p.user_id = u.id
JOIN stackoverflow.post_types as pt ON pt.id = p.post_type_id
WHERE pt.type = 'Answer' AND
p.creation_date::date BETWEEN u.creation_date AND (u.creation_date::date + INTERVAL '1 month')
GROUP BY u.display_name
HAVING count(p.user_id)>100
ORDER BY u.display_name
'''
query_3 = '''WITH  dt as (SELECT u.id
FROM stackoverflow.posts as p
JOIN  stackoverflow.users as u ON p.user_id = u.id
WHERE DATE_TRUNC('month', u.creation_date) = '2008-09-01' AND
DATE_TRUNC('month', p.creation_date) = '2008-12-01')
SELECT date_trunc('month', p.creation_date)::date as month, count(p.id)
FROM stackoverflow.posts as p
WHERE p.user_id in (SELECT * FROM dt) AND
EXTRACT(YEAR FROM p.creation_date) = '2008'
GROUP BY month
ORDER BY month DESC
'''
query_4 = '''SELECT user_id, AVG(avg_daily)
FROM (SELECT DISTINCT user_id, date_trunc('day', creation_date)::date as t,
count(id) OVER (PARTITION BY user_id, date_trunc('day', creation_date)::date) as avg_daily,
count(id) OVER (PARTITION BY user_id, date_trunc('month', creation_date)::date) as cnt
FROM stackoverflow.posts
WHERE date_trunc('month', creation_date)::date = '2008-08-01') as dt
WHERE cnt>120
GROUP BY user_id
ORDER BY AVG(avg_daily)
'''

examples = {'–í—ã–≤–æ–¥–∏—Ç –æ–±—â—É—é —Å—É–º–º—É –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –ø–æ—Å—Ç–æ–≤ –∑–∞ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü 2008 –≥–æ–¥–∞':query_1,
            '–í—ã–≤–æ–¥–∏—Ç –∏–º–µ–Ω–∞ —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –≤ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–≤–∫–ª—é—á–∞—è –¥–µ–Ω—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏) –¥–∞–ª–∏ –±–æ–ª—å—à–µ 100 –æ—Ç–≤–µ—Ç–æ–≤':query_2,
            '–í—ã–≤–æ–¥–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ –∑–∞ 2008 –≥–æ–¥ –ø–æ –º–µ—Å—è—Ü–∞–º. –û—Ç–±–∏—Ä–∞–µ—Ç –ø–æ—Å—Ç—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤ —Å–µ–Ω—Ç—è–±—Ä–µ 2008 –≥–æ–¥–∞ –∏ —Å–¥–µ–ª–∞–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –ø–æ—Å—Ç –≤ –¥–µ–∫–∞–±—Ä–µ —Ç–æ–≥–æ –∂–µ –≥–æ–¥–∞.':query_3,
            '–ù–∞–π–¥–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥–µ–Ω—å –∑–∞ –∞–≤–≥—É—Å—Ç 2008 –≥–æ–¥–∞. –û—Ç–±–µ—Ä–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏ –±–æ–ª—å—à–µ 120 –ø–æ—Å—Ç–æ–≤ –∑–∞ –∞–≤–≥—É—Å—Ç. –î–Ω–∏ –±–µ–∑ –ø—É–±–ª–∏–∫–∞—Ü–∏–π –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç.':query_4,
            }
with st.expander("–°—Ö–µ–º–∞ –±—ã–∑–∞ –¥–∞–Ω–Ω—ã—Ö"):
    image = Image.open('project_1/image/Frame.png')
    st.image(image)
    
with st.expander("–ü—Ä–∏–º–µ—Ä—ã SQL –∑–∞–ø—Ä–æ—Å–æ–≤"):
    
    query = st.selectbox('–í—ã–±–µ—Ä–µ—Ç–µ –æ–¥–∏–Ω –∏–∑ –∑–∞–ø—Ä–æ—Å–æ–≤:', ('–í—ã–≤–æ–¥–∏—Ç –æ–±—â—É—é —Å—É–º–º—É –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –ø–æ—Å—Ç–æ–≤ –∑–∞ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü 2008 –≥–æ–¥–∞',
                                                        '–í—ã–≤–æ–¥–∏—Ç –∏–º–µ–Ω–∞ —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –≤ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–≤–∫–ª—é—á–∞—è –¥–µ–Ω—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏) –¥–∞–ª–∏ –±–æ–ª—å—à–µ 100 –æ—Ç–≤–µ—Ç–æ–≤',
                                                        '–í—ã–≤–æ–¥–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ –∑–∞ 2008 –≥–æ–¥ –ø–æ –º–µ—Å—è—Ü–∞–º. –û—Ç–±–∏—Ä–∞–µ—Ç –ø–æ—Å—Ç—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤ —Å–µ–Ω—Ç—è–±—Ä–µ 2008 –≥–æ–¥–∞ –∏ —Å–¥–µ–ª–∞–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –ø–æ—Å—Ç –≤ –¥–µ–∫–∞–±—Ä–µ —Ç–æ–≥–æ –∂–µ –≥–æ–¥–∞.',
                                                        '–ù–∞–π–¥–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥–µ–Ω—å –∑–∞ –∞–≤–≥—É—Å—Ç 2008 –≥–æ–¥–∞. –û—Ç–±–µ—Ä–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏ –±–æ–ª—å—à–µ 120 –ø–æ—Å—Ç–æ–≤ –∑–∞ –∞–≤–≥—É—Å—Ç. –î–Ω–∏ –±–µ–∑ –ø—É–±–ª–∏–∫–∞—Ü–∏–π –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç.',
                                                        ))
    
    st.code(examples[query], language="sql", line_numbers=False)
    if st.button("–ó–∞–ø—É—Å–∫ –∑–∞–ø—Ä–æ—Å–∞"):
        st.markdown('## –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞:')
        st.write(query_db(examples[query]))

def clear_text():
    st.session_state.title = ""

def submit():
    st.session_state.title = st.session_state.widget
    st.session_state.widget = ""

st.text_input("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à SQL –∑–∞–ø—Ä–æ—Å", key="widget", on_change=submit)

title = st.session_state.title    

if title not in st.session_state:
    st.session_state.title = ""    

# st.write(title)       
# title = st.text_input('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à SQL –∑–∞–ø—Ä–æ—Å')
        
if title:
    st.markdown('## –í–∞—à –∑–∞–ø—Ä–æ—Å:')
    st.code(title, language="sql", line_numbers=False)
    st.markdown('## –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞:')
    try:
        st.write(query_db(title))
    except:
        '–ó–∞–ø—Ä–æ—Å –Ω–µ–≤–µ—Ä–µ–Ω, —É–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞'
    
    
        




